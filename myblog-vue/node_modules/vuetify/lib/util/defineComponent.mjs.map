{"version":3,"sources":["../../src/util/defineComponent.tsx"],"names":["getCurrentInstance","shallowReactive","toRaw","watchEffect","consoleWarn","toKebabCase","useDefaults","propIsDefined","vnode","prop","props","hasOwnProperty","defineComponent","options","_setup","setup","name","ctx","vm","defaults","_props","globalDefaults","value","global","componentDefaults","Object","keys","newVal"],"mappings":"AAAA;AACA,SAASA,kBAAT,EAA6BC,eAA7B,EAA8CC,KAA9C,EAAqDC,WAArD,QAAwE,KAAxE;SACSC,W;SACAC,W;SACAC,W,uCAET;;AAGA,SAASC,aAAT,CAAwBC,KAAxB,EAAsCC,IAAtC,EAAoD;AAAA;;AAClD,SAAO,iBAAAD,KAAK,CAACE,KAAN,kCAAaC,cAAb,CAA4BF,IAA5B,wBACPD,KAAK,CAACE,KADC,qBACP,cAAaC,cAAb,CAA4BN,WAAW,CAACI,IAAD,CAAvC,CADO,CAAP;AAED;;AAED,OAAO,MAAMG,eAAe,GAAI,SAASA,eAAT,CAA0BC,OAA1B,EAAqD;AACnF,QAAMC,MAAM,GAAGD,OAAO,CAACE,KAAvB;;AAEA,MAAI,CAACF,OAAO,CAACG,IAAb,EAAmB;AACjBZ,IAAAA,WAAW,CAAC,kFAAD,CAAX;AAEA,WAAOS,OAAP;AACD;;AAED,MAAIC,MAAJ,EAAY;AACVD,IAAAA,OAAO,CAACE,KAAR,GAAgB,SAASA,KAAT,CAAgBL,KAAhB,EAAwCO,GAAxC,EAA6C;AAC3D,YAAMC,EAAE,GAAGlB,kBAAkB,EAA7B;AACA,YAAMmB,QAAQ,GAAGb,WAAW,EAA5B;;AAEA,YAAMc,MAAM,GAAGnB,eAAe,CAAC,EAAE,GAAGC,KAAK,CAACQ,KAAD;AAAV,OAAD,CAA9B;;AACAP,MAAAA,WAAW,CAAC,MAAM;AAChB,cAAMkB,cAAc,GAAGF,QAAQ,CAACG,KAAT,CAAeC,MAAtC;AACA,cAAMC,iBAAiB,GAAGL,QAAQ,CAACG,KAAT,CAAeT,OAAO,CAACG,IAAvB,CAA1B;;AAEA,aAAK,MAAMP,IAAX,IAAmBgB,MAAM,CAACC,IAAP,CAAYhB,KAAZ,CAAnB,EAAuC;AACrC,cAAIiB,MAAJ;;AACA,cAAIpB,aAAa,CAACW,EAAE,CAACV,KAAJ,EAAWC,IAAX,CAAjB,EAAmC;AACjCkB,YAAAA,MAAM,GAAGjB,KAAK,CAACD,IAAD,CAAd;AACD,WAFD,MAEO;AAAA;;AACLkB,YAAAA,MAAM,oCAAGH,iBAAH,oBAAGA,iBAAiB,CAAGf,IAAH,CAApB,oCAAgCY,cAAhC,oBAAgCA,cAAc,CAAGZ,IAAH,CAA9C,mBAA0DC,KAAK,CAACD,IAAD,CAArE;AACD;;AACD,cAAIW,MAAM,CAACX,IAAD,CAAN,KAAiBkB,MAArB,EAA6B;AAC3BP,YAAAA,MAAM,CAACX,IAAD,CAAN,GAAekB,MAAf;AACD;AACF;AACF,OAfU,CAAX;AAiBA,aAAOb,MAAM,CAACM,MAAD,EAASH,GAAT,CAAb;AACD,KAvBD;AAwBD;;AAED,SAAOJ,OAAP;AACD,CArCM","sourcesContent":["// Utils\nimport { getCurrentInstance, shallowReactive, toRaw, watchEffect } from 'vue'\nimport { consoleWarn } from '@/util/console'\nimport { toKebabCase } from '@/util/helpers'\nimport { useDefaults } from '@/composables/defaults'\n\n// Types\nimport type { defineComponent as _defineComponent, ComponentOptions, VNode } from 'vue'\n\nfunction propIsDefined (vnode: VNode, prop: string) {\n  return vnode.props?.hasOwnProperty(prop) ||\n  vnode.props?.hasOwnProperty(toKebabCase(prop))\n}\n\nexport const defineComponent = (function defineComponent (options: ComponentOptions) {\n  const _setup = options.setup\n\n  if (!options.name) {\n    consoleWarn('The component is missing an explicit name, unable to generate default prop value')\n\n    return options\n  }\n\n  if (_setup) {\n    options.setup = function setup (props: Dictionary<any>, ctx) {\n      const vm = getCurrentInstance()!\n      const defaults = useDefaults()\n\n      const _props = shallowReactive({ ...toRaw(props) })\n      watchEffect(() => {\n        const globalDefaults = defaults.value.global\n        const componentDefaults = defaults.value[options.name!]\n\n        for (const prop of Object.keys(props)) {\n          let newVal\n          if (propIsDefined(vm.vnode, prop)) {\n            newVal = props[prop]\n          } else {\n            newVal = componentDefaults?.[prop] ?? globalDefaults?.[prop] ?? props[prop]\n          }\n          if (_props[prop] !== newVal) {\n            _props[prop] = newVal\n          }\n        }\n      })\n\n      return _setup(_props, ctx)\n    }\n  }\n\n  return options\n}) as unknown as typeof _defineComponent\n"],"file":"defineComponent.mjs"}